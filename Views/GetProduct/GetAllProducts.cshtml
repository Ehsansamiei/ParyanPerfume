@using DataLayer
@model IEnumerable<Products>

@{
	Layout = "~/Views/Shared/Admin/_AdminLayout.cshtml";
}

<head>

	<link href="~/css/styles.css" rel="stylesheet" />
	<script type="importmap"></script>
	<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="~/css/GetAllProducts.css" />
</head>

<table>
	<tr>
		<th>تصویر</th>
		<th>نام محصول</th>
		<th>نام محصول (لاتین)</th>
		<th>توضیحات</th>
		<th>عملیات</th>
	</tr>
	@foreach (var item in Model)
	{
		<tr>
			<td>
				<img src="/ProductImages/@item.ImageName" class="thumbnail" style="max-width:120px" />
			</td>
			<td>@item.ProductName</td>
			<td>@item.ProductNickName</td>
			<td>@item.ProductDescription</td>
			<td>
				<a class="btn btn-info btn-sm" href="/Admin/Products/Details/@item.ProductId">جزیيات</a>
				<a class="btn btn-warning btn-sm" href="/Admin/Products/Edit/@item.ProductId">ویرایش</a>
				<a href="#" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal"
					data-product-id="@item.ProductId" data-product-name="@item.ProductName"
					data-product-image="/ProductImages/@item.ImageName">
					حذف
				</a>

			</td>
		</tr>
	}
</table>

<a href="/admin/products/create" class="btn btn-success"> جدید +</a>

<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">حذف محصول</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="بستن"></button>
            </div>
            <div class="modal-body text-center">
                <p>آیا مطمئن هستید که می‌خواهید این محصول را حذف کنید؟</p>
                <h4 id="modalProductName"></h4>
                <img id="modalProductImage" src="" class="img-thumbnail" style="max-width: 150px;" />
            </div>
            <div class="modal-footer">
                <form id="deleteForm" method="post">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">لغو</button>
                    <button type="submit" class="btn btn-danger">تأیید حذف</button>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
    var deleteModal = document.getElementById('deleteModal');
    deleteModal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var productId = button.getAttribute('data-product-id');
        var productName = button.getAttribute('data-product-name');
        var productImage = button.getAttribute('data-product-image');

        var modalProductName = deleteModal.querySelector('#modalProductName');
        var modalProductImage = deleteModal.querySelector('#modalProductImage');
        var deleteForm = deleteModal.querySelector('#deleteForm');

        modalProductName.textContent = productName;
        modalProductImage.src = productImage;
        deleteForm.action = '/Admin/Products/Delete/' + productId;
    });
</script>
